# Represents a billing entry associated with a Subgraph deployment or an Account
type BillingEntry @entity {
  # Unique identifier for the billing entry
  id: ID!
  # Current balance of tokens for the Subgraph or Account
  balance: BigInt!
  # Tokens received
  tokensIn: BigInt!
  # GRT withdrawn
  withdrawnGRT: BigInt!
  # Query fees withdrawn
  withdrawnQueryFees: BigInt!
  # Timestamp of the billing entry
  timestamp: BigInt!
  # Field for referencing a Subgraph
  subgraph: Subgraph!
  # Field for referencing an Account
  account: Account!
  # Deployment associated with billings
  billings: SubgraphDeployment!
}

# Represents a Subgraph entity
type Subgraph @entity {
  # Unique identifier for the Subgraph
  id: ID!
  # Account entity associated with this subgraph
  owner: Account!
  # Token ID
  tokenID: BigInt!
  # List of billing entries associated with the Subgraph
  billing: [BillingEntry!]! @derivedFrom(field: "subgraph")
  # Metadata associated with the Subgraph
  metadata: SubgraphMetadata!
  # List of versions associated with the Subgraph
  versions: [SubgraphVersion!]! @derivedFrom(field: "version")
}

# Represents an Account entity
type Account @entity {
  # Unique identifier for the Account
  id: ID!
  # Time the account was created
  createdAt: BigInt!
  # Owner's Ethereum address
  address: Bytes!
  # List of subgraphs associated with this account
  subgraphs: [Subgraph!]! @derivedFrom(field: "owner")
  # List of billing entries associated with the Account
  billing: [BillingEntry!]! @derivedFrom(field: "account")
}

# Represents metadata associated with a Subgraph
type SubgraphMetadata
  @entity(immutable: true) { # Updated type name
  # Metadata from IPFS linked in GNS
  id: ID!
  # The name of the subgraph.
  name: String!
  # Subgraph metadata IPFS hash
  ipfsMetadataHash: Bytes!
  # Subgraph URI
  subgraphUri: Bytes!
  # Short description of the subgraph
  description: String
  # Image in string format
  image: String
  # NFT Image representation
  nftImage: String
  # Location of the code for this project
  codeRepository: String
  # Project's website
  website: String
}

# Represents a version of a Subgraph
type SubgraphVersion {
  # Unique identifier for the SubgraphVersion
  id: ID!
  # Label for the version
  label: String!
  # Subgraph Deployment ID. The IPFS hash with Qm removed to fit into 32 bytes
  currentVersionId: Bytes!
  # Versions associated with Subgraph
  version: Subgraph!
  # List of deployments associated with the version
  deployments: [SubgraphDeployment!]! @derivedFrom(field: "deploymentList")
}

# Represents a deployment of a Subgraph version
type SubgraphDeployment {
  # Unique identifier for the deployment
  id: ID!
  # Staked tokens for the deployment
  stakedTokens: BigInt!
  # Signal amount for the deployment
  signalAmount: BigInt!
  # Timestamp of deployment creation
  createdAt: DateTime! # Updated to use a specific timestamp type
  # Block of deployment creation
  blocknumber: BigInt!
  # Version associated with the deployment
  deploymentList: SubgraphVersion!
  # List of billing entries associated with the deployment
  billing: [BillingEntry!]! @derivedFrom(field: "deploymentList")
}
